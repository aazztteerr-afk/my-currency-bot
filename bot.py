@bot.message_handler(commands=['start', 'rate'])
def start_message(message):
    try:
        # –û—Ç—Ä–∏–º—É—î–º–æ –¥–∞–Ω—ñ –≤—ñ–¥ –ù–ë–£
        url = "https://bank.gov.ua/NBUStatService/v1/statdirectory/exchange?json"
        data = requests.get(url, timeout=10).json()
        usd = next(item for item in data if item["cc"] == "USD")["rate"]
        eur = next(item for item in data if item["cc"] == "EUR")["rate"]

        # --- –ë–õ–û–ö –ê–ù–ê–õ–Ü–¢–ò–ö–ò ---
        # –í–∏–∑–Ω–∞—á–∞—î–º–æ —Ä—ñ–≤–Ω—ñ (–º–æ–∂–Ω–∞ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ —Ü–∏—Ñ—Ä–∏ –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å–∏—Ç—É–∞—Ü—ñ—ó –Ω–∞ —Ä–∏–Ω–∫—É)
        buy_level = 41.20  # –ù–∏–∂—á–µ —Ü—å–æ–≥–æ - –≤–∏–≥—ñ–¥–Ω–æ –∫—É–ø—É–≤–∞—Ç–∏
        sell_level = 42.00 # –í–∏—â–µ —Ü—å–æ–≥–æ - –≤–∏–≥—ñ–¥–Ω–æ –ø—Ä–æ–¥–∞–≤–∞—Ç–∏

        if usd < buy_level:
            advice = "üü¢ **–†–ï–ö–û–ú–ï–ù–î–ê–¶–Ü–Ø: –ö–£–ü–£–í–ê–¢–ò.**\n–ö—É—Ä—Å –∑–∞—Ä–∞–∑ –Ω–∏–∂—á–µ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ —Ä–∏–Ω–∫–æ–≤–æ–≥–æ —Ä—ñ–≤–Ω—è. –¶–µ —Ö–æ—Ä–æ—à–∏–π –º–æ–º–µ–Ω—Ç –¥–ª—è –∑–∞–æ—â–∞–¥–∂–µ–Ω—å —É –≤–∞–ª—é—Ç—ñ."
        elif usd > sell_level:
            advice = "üî¥ **–†–ï–ö–û–ú–ï–ù–î–ê–¶–Ü–Ø: –ó–ê–ß–ï–ö–ê–¢–ò.**\n–ö—É—Ä—Å –¥–æ—Å–∏—Ç—å –≤–∏—Å–æ–∫–∏–π. –Ø–∫—â–æ –Ω–µ–º–∞—î —Ç–µ—Ä–º—ñ–Ω–æ–≤–æ—ó –ø–æ—Ç—Ä–µ–±–∏, –∫—Ä–∞—â–µ –Ω–µ –∫—É–ø—É–≤–∞—Ç–∏ "–Ω–∞ –ø—ñ–∫—É", –º–æ–∂–ª–∏–≤–∏–π –≤—ñ–¥–∫–∞—Ç."
        else:
            advice = "üü° **–†–ï–ö–û–ú–ï–ù–î–ê–¶–Ü–Ø: –¢–†–ò–ú–ê–¢–ò.**\n–ö—É—Ä—Å —É –º–µ–∂–∞—Ö –Ω–æ—Ä–º–∏. –†–∏–Ω–æ–∫ —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π, –∑–¥—ñ–π—Å–Ω—é–π—Ç–µ –æ–ø–µ—Ä–∞—Ü—ñ—ó —Ç—ñ–ª—å–∫–∏ –∑–∞ –ø–æ—Ç—Ä–µ–±–∏."

        # –§–æ—Ä–º—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
        text = (
            f"üìä **–ê–ù–ê–õ–Ü–¢–ò–ö–ê –ö–£–†–°–£ –í–ê–õ–Æ–¢**\n"
            f"‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            f"üíµ **–î–æ–ª–∞—Ä (USD):** {usd:.2f} –≥—Ä–Ω\n"
            f"üí∂ **–Ñ–≤—Ä–æ (EUR):** {eur:.2f} –≥—Ä–Ω\n"
            f"‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
            f"{advice}\n\n"
            f"üí° *–ó–∞–≤–∂–¥–∏ –ø–∞–º'—è—Ç–∞–π—Ç–µ: –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞ –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ –æ—Ñ—ñ—Ü—ñ–π–Ω–∏—Ö –¥–∞–Ω–∏—Ö –ù–ë–£ —ñ –Ω–µ —î —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–æ—é –≥–∞—Ä–∞–Ω—Ç—ñ—î—é.*"
        )
        
        bot.send_message(message.chat.id, text, parse_mode='Markdown')
    except Exception as e:
        bot.send_message(message.chat.id, "‚ùå –°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏.")
